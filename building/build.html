
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>ðŸ›  Build the packages Â· ALICE Analysis Tutorial</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-panels/panels.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-block-align/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../css/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="precomp.html" />
    
    
    <link rel="prev" href="manual-install.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../start/">
            
                <a href="../start/">
            
                    
                    Getting started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../start/cert.html">
            
                <a href="../start/cert.html">
            
                    
                    Get a Grid certificate
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    Build ALICE software
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="custom.html">
            
                <a href="custom.html">
            
                    
                    ðŸ§ª Installation via alibuild
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="prereq-centos7.html">
            
                <a href="prereq-centos7.html">
            
                    
                    Prerequisites for CentOS 7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="prereq-centos8.html">
            
                <a href="prereq-centos8.html">
            
                    
                    Prerequisites for CentOS 8
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="prereq-alma9.html">
            
                <a href="prereq-alma9.html">
            
                    
                    Prerequisites for Alma 9
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="prereq-macos.html">
            
                <a href="prereq-macos.html">
            
                    
                    Prerequisites for macOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="prereq-ubuntu.html">
            
                <a href="prereq-ubuntu.html">
            
                    
                    Prerequisites for Ubuntu
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="prereq-fedora.html">
            
                <a href="prereq-fedora.html">
            
                    
                    Prerequisites for Fedora
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="manual-install.html">
            
                <a href="manual-install.html">
            
                    
                    Fall-back manual installation method
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3.2" data-path="build.html">
            
                <a href="build.html">
            
                    
                    ðŸ›  Build the packages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="precomp.html">
            
                <a href="precomp.html">
            
                    
                    ðŸ“¦ Use the precompiled binaries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="devel.html">
            
                <a href="devel.html">
            
                    
                    ðŸ’ª Develop a single package (Experimental)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <a target="_blank" href="https://aliceo2group.github.io/analysis-framework/">
            
                    
                    O2 Analysis Framework Documentation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../analysis/welcome.html">
            
                <a href="../analysis/welcome.html">
            
                    
                    Writing an analysis task
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../analysis/welcome.html">
            
                <a href="../analysis/welcome.html">
            
                    
                    Writing an analysis task
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="../analysis/classes.html">
            
                <a href="../analysis/classes.html">
            
                    
                    AliAnalysisTaskSE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="../analysis/alianalysistaskmytask.html">
            
                <a href="../analysis/alianalysistaskmytask.html">
            
                    
                    Your analysis task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.3" data-path="../analysis/local.html">
            
                <a href="../analysis/local.html">
            
                    
                    Running locally
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.4" data-path="../analysis/rungrid.html">
            
                <a href="../analysis/rungrid.html">
            
                    
                    Running on Grid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.5" data-path="../analysis/lego.html">
            
                <a href="../analysis/lego.html">
            
                    
                    The LEGO train system
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.6" data-path="../analysis/monalisa.html">
            
                <a href="../analysis/monalisa.html">
            
                    
                    AliMonitor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.7" data-path="../analysis/oadb.html">
            
                <a href="../analysis/oadb.html">
            
                    
                    Offline analysis database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.8" data-path="../analysis/trouble.html">
            
                <a href="../analysis/trouble.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.9" data-path="../analysis/streamer.html">
            
                <a href="../analysis/streamer.html">
            
                    
                    The ROOT streamer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.10" data-path="../analysis/destructor.html">
            
                <a href="../analysis/destructor.html">
            
                    
                    Destructors
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../analysis/">
            
                <a href="../analysis/">
            
                    
                    Analysis tutorial exercises
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../analysis/setup.html">
            
                <a href="../analysis/setup.html">
            
                    
                    Step 1 - Setup the tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="../analysis/running.html">
            
                <a href="../analysis/running.html">
            
                    
                    Step 2 - Running the task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="../analysis/modify.html">
            
                <a href="../analysis/modify.html">
            
                    
                    Step 3 - Modify the task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="../analysis/track.html">
            
                <a href="../analysis/track.html">
            
                    
                    Step 4 -The track loop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.5" data-path="../analysis/pid.html">
            
                <a href="../analysis/pid.html">
            
                    
                    Step 5 -Particle identification
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6" data-path="../analysis/MC.html">
            
                <a href="../analysis/MC.html">
            
                    
                    Step 6 -Using Monte Carlo data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.7" data-path="../analysis/grid.html">
            
                <a href="../analysis/grid.html">
            
                    
                    Step 7 -Run your code on GRID
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.8" data-path="../analysis/bonus.html">
            
                <a href="../analysis/bonus.html">
            
                    
                    Bonus content
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.9" data-path="../analysis/hints.html">
            
                <a href="../analysis/hints.html">
            
                    
                    Some hints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.10" data-path="../analysis/ROOT5-to-6.html">
            
                <a href="../analysis/ROOT5-to-6.html">
            
                    
                    Transition from ROOT5 to ROOT6
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../rivet/rivet-tutorial.html">
            
                <a href="../rivet/rivet-tutorial.html">
            
                    
                    Rivet
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../rivet/getting-started.html">
            
                <a href="../rivet/getting-started.html">
            
                    
                    Getting started with Rivet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../rivet/rivet-in-alice.html">
            
                <a href="../rivet/rivet-in-alice.html">
            
                    
                    Using Rivet in ALICE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../rivet/implementing-rivet-analysis.html">
            
                <a href="../rivet/implementing-rivet-analysis.html">
            
                    
                    Implementing a Rivet analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../rivet/hi-features.html">
            
                <a href="../rivet/hi-features.html">
            
                    
                    Introduction to heavy-ion features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../rivet/reference-manual.html">
            
                <a href="../rivet/reference-manual.html">
            
                    
                    Reference manual for Rivet in ALICE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../rivet/publishing-procedures.html">
            
                <a href="../rivet/publishing-procedures.html">
            
                    
                    Procedures for publishing Rivet analyses
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../rivet/advanced-topics.html">
            
                <a href="../rivet/advanced-topics.html">
            
                    
                    Advanced topics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../rivet/advanced-hi-features.html">
            
                <a href="../rivet/advanced-hi-features.html">
            
                    
                    Advanced heavy-ion features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="../rivet/coding-conventions.html">
            
                <a href="../rivet/coding-conventions.html">
            
                    
                    Coding conventions for Rivet plugins
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="../rivet/references.html">
            
                <a href="../rivet/references.html">
            
                    
                    References
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../CONTRIBUTING.html">
            
                <a href="../CONTRIBUTING.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >ðŸ›  Build the packages</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x1F6E0;-build-the-packages">&#x1F6E0; Build the packages</h1>
<p>ALICE software has several dependencies: aliBuild takes care of downloading them for you. aliBuild
will also automatically download precompiled binaries on <a href="custom.html#operating-systems-we-support">supported versions</a> of CentOS/Alma and Ubuntu.</p>
<p>aliBuild will download and compile all the dependencies caching data under <code>$ALIBUILD_WORK_DIR</code>. You
will never need to access this directory. The source code for the packages you will actually develop
will be stored elsewhere.</p>
<p>In the following example, we will assume that you need to download AliRoot/AliPhysics for developing
Run 2 software, and O2/O2Physics for Run 3.</p>
<h2 id="prepare-your-source-code">Prepare your source code</h2>
<p>We assume your work area is <code>~/alice</code>.
So, first off, create the directory and move to it:</p>
<pre><code class="lang-bash">mkdir -p ~/alice
<span class="hljs-built_in">cd</span> ~/alice
</code></pre>
<p>If you want to develop analysis code, download AliPhysics:</p>
<pre><code class="lang-bash">aliBuild init AliPhysics@master
</code></pre>
<p>Only if you need to develop the Run 2 core software (unlikely), download AliRoot:</p>
<pre><code class="lang-bash">aliBuild init AliRoot@master
</code></pre>
<p>If you need to develop for Run 3, download O2Physics:</p>
<pre><code class="lang-bash">aliBuild init O2Physics@master
</code></pre>
<p>Only if you need to develop the Run 3 core software (unlikely), download O2:</p>
<pre><code class="lang-bash">aliBuild init O2@dev
</code></pre>
<h3 id="source-code-and-recipes">Source code and recipes</h3>
<p>If you perform <code>ls</code> under your work directory, you will see the packages you have downloaded via
<code>aliBuild init</code>, plus an <code>alidist</code> directory.</p>
<p>The <code>alidist</code> directory contains software recipes, telling aliBuild how the software is built. Your
<code>alidist</code> directory and your software source code are Git directories <strong>managed by you</strong>: you need
to keep them up-to-date manually.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(3554785021);" id="check-names-of-your-remote-repositories"><i class="fa fa-info-circle"></i> Check names of your remote repositories<span id="heading-3554785021"></span></h3></div><div class="panel-body" id="panel-3554785021"><p>With older versions of aliBuild, the central remote repository (used for pulling updates) would be
called <code>origin</code> instead of the usual name <code>upstream</code> and the personal (fork) remote repository (used
for pushing changes) would be called <code>&lt;your-github-username&gt;</code> instead of the usual name <code>origin</code>.
Please check your settings using <code>git remote -v</code> and adjust the Git commands mentioned in
the following instructions accordingly, if needed.</p>
</div></div></p>
<p>Update your software by <code>cd</code>ing into its directory and running:</p>
<pre><code class="lang-bash"><span class="hljs-comment"># use dev instead of master for O2</span>
git checkout master
git pull --rebase upstream master
</code></pre>
<p>This will work in most cases and will keep your changes. It will also complain if there is some
conflict you need to solve manually. You also have the nuclear option, to be used if you are sure
you do not have any important data:</p>
<pre><code class="lang-bash"><span class="hljs-comment"># use dev instead of master for O2</span>
git checkout master
git fetch --all
git reset --hard upstream/master
</code></pre>
<p>Instead of resetting to the current upstream version, you may want to download specific versions of
the software:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice/AliPhysics
git fetch --all --tags
git checkout v5-09-42-01
</code></pre>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(9143391774);" id="why-manual-updates"><i class="fa fa-info-circle"></i> Why manual updates?<span id="heading-9143391774"></span></h3></div><div class="panel-body" id="panel-9143391774"><p>Software downloaded under your working directory is your responsibility. Our tools will not take any
action to update it: imagine if you lose important data because of an automatic update!</p>
<p>As a developer, and ALICE contributor, you must be capable of using and understanding <code>git</code>.</p>
</div></div></p>
<h2 id="check-your-prerequisites">Check your prerequisites</h2>
<p>aliBuild comes with the command <code>aliDoctor</code> that will help you identifying if your prerequisites
were installed correctly. In general, aliBuild is capable of building all required software
dependencies, but it has also the ability to take them &quot;from the system&quot; if possible, resulting in
less time spent for building for you.</p>
<p>Run the <code>aliDoctor</code> command to check dependencies for Run 2 software:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice
aliDoctor AliPhysics
</code></pre>
<p>For Run 2 software based on ROOT 6 (note: this is the only option on macOS):</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice
aliDoctor AliPhysics
</code></pre>
<p>For Run 3 software:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice
aliDoctor O2Physics
</code></pre>
<p>aliDoctor will warn you that some packages have to be built as they could not be found from the
system. If you have followed the instructions, this list should contain <strong>nothing more than</strong>:</p>
<ul>
<li>boost</li>
<li>CMake</li>
<li>GSL</li>
<li>nanomsg</li>
<li>protobuf</li>
<li>flatbuffers</li>
<li>Vc</li>
<li>yaml-cpp</li>
<li>ZeroMQ</li>
<li>SWIG</li>
</ul>
<p>In particular, you should never have <code>Python</code> or <code>Python-modules</code>. If the output is longer than this
list, please go through the prerequisites once again and run <code>aliDoctor</code> again. If the output
contains those packages, or less packages, then you are fine and you may continue.</p>
<blockquote>
<p>If you think a package is shown but should not be in the list because you are sure you have
installed it, it might just be that its version it&apos;s incompatible (this frequently happens with
<code>CMake</code>) or you are missing the &quot;development&quot; package for that component.</p>
</blockquote>
<h2 id="build-and-rebuild">Build and rebuild</h2>
<p>You can build the whole Run 2 software stack based on ROOT 6 with:</p>
<pre><code>cd ~/alice
aliBuild build AliPhysics
</code></pre><p>Similarly, for O2Physics:</p>
<pre><code>cd ~/alice
aliBuild build O2Physics
</code></pre><p>If you want to build O2 and run the tests as well (same way as they are run on the pull request
checkers), with <code>--debug</code> to see the full output:</p>
<pre><code>cd ~/alice
aliBuild build O2 --debug -e ALIBUILD_O2_TESTS=1
</code></pre><p><em>&#x26A0;&#xFE0F;  It is recommended to run the first O2 build without the tests enabled to let it complete. You
will not have to rerun it from scratch because of test failures like this.</em></p>
<p>Using the combinations above on CentOS 7 will make aliBuild automatically download the precompiled 
binaries for almost all packages.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(7889230814);" id="aliphysics-with-root-6-and-the-grid"><i class="fa fa-info-circle"></i> AliPhysics with ROOT 6 and the Grid<span id="heading-7889230814"></span></h3></div><div class="panel-body" id="panel-7889230814"><p>The command above will produce AliPhysics with ROOT 6 as a dependency. When using this version, you
will only be able to submit Grid analysis jobs using ROOT 6-based builds (whose name ends with
<code>_ROOT6</code>). If you still need ROOT 5 only for submitting Grid jobs, there is no need to install it:
just <a href="precomp.html">use it from CVMFS</a> by logging in to <code>lxplus.cern.ch</code>.</p>
</div></div></p>
<h3 id="other-build-options">Other build options</h3>
<p>The options above are suitable for a CentOS 7 installation, since precompiled binaries
will be downloaded. You also have other installation options according to your needs: it is not
guaranteed that cached binaries are available for the following options, but they may be faster to
build.</p>
<p><strong>Build AliPhysics based on ROOT 5 (legacy):</strong></p>
<pre><code class="lang-bash">aliBuild build AliPhysics --defaults user      <span class="hljs-comment"># without GEANT 3, GEANT 4, DPMJET</span>
aliBuild build AliPhysics --defaults release   <span class="hljs-comment"># full ROOT 5 stack</span>
</code></pre>
<p><em>&#x26A0;&#xFE0F;  ROOT 5 does not work on macOS. Use a ROOT 6 version compatible with ROOT 5 if you really need it
(see below).</em></p>
<hr>
<h3 id="rebuild-existing-installations">Rebuild existing installations</h3>
<p>As a general rule, your existing installation can be smartly rebuilt by using the exact same
<code>aliBuild build</code> command as you did the first time. aliBuild will not rebuild existing software and
it will simply rebuild the changes.</p>
<p>You may find it fast to skip the aliBuild part completely. You can simply move to the build
directory and run <code>make</code> (the <code>alienv</code> part is <a href="#run-a-single-command-in-the-environment">explained
later</a>):</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> <span class="hljs-variable">$ALIBUILD_WORK_DIR</span>/BUILD/AliPhysics-latest/AliPhysics
alienv setenv GCC-Toolchain/latest -c cmake --build . -- -j &lt;num-parallel-jobs&gt; install
</code></pre>
<p>Replace <code>&lt;num-parallel-jobs&gt;</code> with a sensible number (<em>e.g.</em> slightly more than the actual number of
your cores).</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(4450673246);" id="you-lied-alibuild-is-rebuilding-everything-&#x1F92C;"><i class="fa fa-info-circle"></i> You lied. aliBuild is rebuilding everything! &#x1F92C;<span id="heading-4450673246"></span></h3></div><div class="panel-body" id="panel-4450673246"><p>One or more of the following actions might change the way aliBuild sees and uses the dependencies
and might result in a <strong>full</strong> (or nearly) rebuild. So, if an important conference is approaching
(well: it always does, doesn&apos;t it?) <strong>plan the following actions accordingly as they might increase
the build time</strong>:</p>
<ul>
<li>Updating recipes in <code>alidist</code></li>
<li>Removing the cache <code>$ALIBUILD_WORK_DIR</code> or forgetting to export the variable</li>
<li>Adding or removing system dependencies as seen by <code>aliDoctor</code></li>
<li>Updating your operating system or compilers (including Xcode on macOS)</li>
</ul>
</div></div></p>
<h2 id="use-your-local-software-installations">Use your local software installations</h2>
<p>You will not find the packages you have built immediately available on your shell: we provide a tool
called <code>alienv</code> that configures your shell according to the packages you want to load. <code>alienv</code> is
capable of switching between different versions of the same package without a hassle.</p>
<p><strong>List your available packages with:</strong></p>
<pre><code class="lang-bash">alienv q
</code></pre>
<p><strong>Load the latest version you have built of a package (AliPhysics for instance):</strong></p>
<pre><code class="lang-bash">alienv enter AliPhysics/latest
</code></pre>
<p><em>&#x26A0;&#xFE0F;  Dependencies are loaded automatically. Do not attempt to load AliRoot and ROOT as well, you will
find them automatically in the environment! <code>alienv enter</code> is verbose and will inform you about the
loaded packages if you have doubts.</em></p>
<p>The <code>alienv enter</code> command drops you to a new shell. Unload the packages by simply exiting it with
the <code>exit</code> command.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(9685253276);" id="i-have-several-aliphysics-versions-which-one-is-aliphysicslatest"><i class="fa fa-info-circle"></i> I have several AliPhysics versions. Which one is AliPhysics/latest?<span id="heading-9685253276"></span></h3></div><div class="panel-body" id="panel-9685253276"><p>aliBuild will tell you exactly what you need to type in order to load the software you have just
built. Just use aliBuild&apos;s suggestion in place of <code>AliPhysics/latest</code> wherever appropriate: for
instance, if you have several AliPhysics versions, <code>AliPhysics/latest</code> will point to the version you
have built more recently, not the latest.</p>
</div></div></p>
<h3 id="load-environment-in-the-current-shell-or-script">Load environment in the current shell or script</h3>
<p>If you know what you are doing, you can also load the environment in your <em>current</em> shell, and
subsequently unload it (this is not recommended):</p>
<pre><code class="lang-bash">alienv load AliPhysics/latest
alienv unload AliPhysics/latest
</code></pre>
<p>If you want to load the environment inside a script you are developing, just add this line (works
with Bash scripts):</p>
<pre><code class="lang-bash"><span class="hljs-built_in">source</span> $(alienv printenv AliPhysics/latest)
</code></pre>
<h3 id="run-a-single-command-in-the-environment">Run a single command in the environment</h3>
<p>You can also run a single command (for instance, <code>aliroot</code>) in the given environment without loading
it in the current shell:</p>
<pre><code class="lang-bash">alienv setenv AliPhysics/latest -c aliroot myMacro.C+
</code></pre>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(822054832);" id="&#x1F6AB;do-not-load-alienv-automatically-in-your-shell"><i class="fa fa-info-circle"></i> &#x1F6AB;Do not load alienv automatically in your shell<span id="heading-822054832"></span></h3></div><div class="panel-body" id="panel-822054832"><p>Even if this is technically possible, it is strongly not recommended to load the environment with
<code>alienv</code> in your <code>~/.bashrc</code>! <strong>You must keep your environment pristine for safely running
aliBuild.</strong> By not loading the environment automatically, you will avoid a huge source of errors.</p>
<p>Do you still find annoying to type <code>alienv enter AliPhysics/latest</code> every time you want to use it?
You can add the following line in your <code>~/.bashrc</code> to make it more convenient:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">alias</span> ali=<span class="hljs-string">&apos;alienv enter AliPhysics/latest&apos;</span>
</code></pre>
<p>You are creating an alias called <code>ali</code>, that will load the environment by just typing it at the
prompt. Of course you can name it any way you want.</p>
</div></div></p>
<h2 id="special-build-needs">Special build needs</h2>
<p>Read below if you have some advanced requirements for your local installation.</p>
<h3 id="build-by-using-less-resources">Build by using less resources</h3>
<p>Building takes by default all the available CPU and most of the memory of your computer,
considerably slowing down your work. In some cases you may want to reduce the number of cores
available to aliBuild by using the <code>-j &lt;num-cores&gt;</code> option:</p>
<pre><code class="lang-bash">aliBuild build AliPhysics -j 1
</code></pre>
<h3 id="do-not-use-the-cache-on-centos-7">Do not use the cache on CentOS 7</h3>
<p>aliBuild will attempt to fetch the precompiled binaries automatically
on CentOS 7: no need to specify extra options.</p>
<p>If you want <em>not</em> to use them for some reason, it is important you follow the <a href="prereq-centos7.html">CentOS 7
prerequisites</a> first: this will allow aliBuild to take as many packages as
possible from the system. You will then need to add the <code>--always-prefer-system</code> option to the
<code>aliBuild build</code> command. For instance:</p>
<pre><code class="lang-bash">aliBuild build AliPhysics --always-prefer-system
</code></pre>
<h3 id="build-the-same-source-multiple-times-with-different-options">Build the same source multiple times with different options</h3>
<p>aliBuild and alienv give you the ability to build the same development source with different
defaults without duplicating the source, and without conflicts.</p>
<p>Imagine we are under <code>~/alice</code> and we have cloned AliRoot and AliPhysics with the <code>aliBuild init</code>
command above. We build AliPhysics <em>twice</em>, once with ROOT 5 and a second time against ROOT 6.</p>
<p><strong>Let&apos;s first build AliPhysics with ROOT 5:</strong></p>
<pre><code class="lang-bash">aliBuild build AliPhysics --defaults user -z aliroot5
</code></pre>
<p><em>&#x26A0;&#xFE0F;  Note the <code>-z aliroot5</code> command; it is assigning a nickname to the build for distinguishing it
more easily when using it.</em></p>
<p>The command ends with a message saying what to do to use the package:</p>
<pre><code class="lang-bash">alienv enter AliPhysics/latest-aliroot5-user
</code></pre>
<hr>
<p><strong>Let&apos;s now build the same AliPhysics with ROOT 6:</strong></p>
<pre><code class="lang-bash">aliBuild build AliPhysics -z aliroot6
</code></pre>
<p>Now, the message tells us to type:</p>
<pre><code class="lang-bash">alienv enter AliPhysics/latest-aliroot6-o2
</code></pre>
<p>Keep in mind that:</p>
<ul>
<li>aliBuild always tells you what is the package name to load at the end of the build</li>
<li>you can load the two environments separately, in two different shells, with no chance of a mixup</li>
<li>you have used the same set of sources for generating two distinct builds</li>
<li><code>alienv enter AliPhysics/latest</code> will load the <em>latest you have built</em>, which can either be the
ROOT 5 or ROOT 6-based version: given its ambiguity, do use explicit names instead</li>
</ul>
<p>It is also possible to directly run <code>aliroot</code> (or any command you want) without &quot;entering&quot; the
environment:</p>
<pre><code class="lang-bash">alienv setenv AliPhysics/latest-aliroot5-user -c aliroot
alienv setenv AliPhysics/latest-aliroot6-o2 -c aliroot
</code></pre>
<p>The <code>aliroot</code> command will be run with the correct environment in both cases.</p>
<p><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(4706636194);" id="migrating-from-root-5-to-root-6"><i class="fa fa-info-circle"></i> Migrating from ROOT 5 to ROOT 6<span id="heading-4706636194"></span></h3></div><div class="panel-body" id="panel-4706636194"><p>While you are at it, if you want to migrate your existing code to ROOT 6 (and make sure it works
there) check out our <a href="../analysis/ROOT5-to-6.html">migration guide</a>.</p>
</div></div></p>
<h3 id="build-specific-releases-tags-of-the-software">Build specific releases (tags) of the software</h3>
<p>It might come useful to build a certain tag of AliRoot and AliPhysics instead of simply pulling the
master.</p>
<blockquote>
<p>Note that <strong>we only guarantee that the current AliPhysics master works against the latest AliRoot
tag!</strong> It is therefore possible (though a rare occurrence) that the current AliRoot master breaks
the current AliPhysics master.</p>
</blockquote>
<p>If you have your source code in &quot;development mode&quot; (<em>i.e.</em> downloaded locally by means of <code>aliBuild
init</code>), since your AliRoot/AliPhysics/O2 directories <a href="#software-and-recipes-must-be-updated-manually">are mere Git
repositories</a>, you simply need to <code>cd</code> into them and
checkout the Git version you want.</p>
<p>For instance, if you want to build AliPhysics against AliRoot v5-09-33, you would need to first
move to the AliRoot directory and check the version out:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice/AliRoot
git fetch upstream --tags
git checkout v5-09-33
</code></pre>
<p>Then update your AliPhysics master:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">cd</span> ~/alice/AliPhysics
git checkout master
git pull --rebase upstream master
</code></pre>
<p>and then build normally using the <code>aliBuild</code> command. You might want to build using different <code>-z</code>
options <a href="#build-the-same-source-multiple-times-with-different-options">as explained here</a> in order
to have different builds usable in parallel without duplicating your source code.</p>
<h2 id="&#x1F9F9;-delete-obsolete-builds">&#x1F9F9; Delete obsolete builds</h2>
<p>With frequent rebuilding of packages, obsolete builds can pile up and occupy a lot of precious
disk space.</p>
<h3 id="basic-cleanup">Basic cleanup</h3>
<p>The simplest way to get rid of obsolete builds is to let aliBuild do its best by running:</p>
<pre><code class="lang-bash">aliBuild clean
</code></pre>
<p>which can take the optional argument <code>--aggressive-cleanup</code> that deletes also source code of built
dependency packages and downloaded <code>.tar.gz</code> archives.</p>
<p>In general, it&apos;s good practice to run <code>aliBuild clean</code> always after <code>aliBuild build</code>.</p>
<p>This might not be enough, as aliBuild will not delete any build directory pointed to by a symlink
that has &quot;latest&quot; in its name, even when that build is not needed by any other package anymore.
Manual intervention is therefore sometimes needed.</p>
<h3 id="deep-cleanup">Deep cleanup</h3>
<p>If you want to keep only the latest builds of your development packages (and their dependencies),
you can make aliBuild delete the rest with a little trick.</p>
<ol>
<li>Delete symlinks to all builds:<pre><code class="lang-bash">find <span class="hljs-variable">$ALIBUILD_WORK_DIR</span>/$(aliBuild architecture)/ -mindepth 2 -maxdepth 2 -type l -delete
find <span class="hljs-variable">$ALIBUILD_WORK_DIR</span>/BUILD/ -mindepth 1 -maxdepth 1 -type l -delete
</code></pre>
In case you specified the architecture manually (using the <code>-a</code> option with <code>aliBuild build</code>), you should replace <code>$(aliBuild architecture)</code> with your manually specified architecture.</li>
<li>Recreate symlinks to the latest builds of development packages (and their dependencies)
by running <code>aliBuild build</code> for each development package.</li>
<li>Let aliBuild delete all the other builds by running <code>aliBuild clean</code>.</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="manual-install.html" class="navigation navigation-prev " aria-label="Previous page: Fall-back manual installation method">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="precomp.html" class="navigation navigation-next " aria-label="Next page: ðŸ“¦ Use the precompiled binaries">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"ðŸ›  Build the packages","level":"1.3.2","depth":2,"next":{"title":"ðŸ“¦ Use the precompiled binaries","level":"1.3.3","depth":2,"path":"building/precomp.md","ref":"building/precomp.md","articles":[]},"previous":{"title":"Fall-back manual installation method","level":"1.3.1.7","depth":3,"path":"building/manual-install.md","ref":"building/manual-install.md","articles":[]},"dir":"ltr"},"config":{"plugins":["katex","panels@git+https://github.com/lhcb/gitbook-plugin-panels.git#117012fdc18c96831cb88196980c0ea73b0c87b8","collapsible-menu","block-align","page-toc"],"styles":{"website":"css/website.css"},"pluginsConfig":{"collapsible-menu":{},"block-align":{},"search":{},"page-toc":{"position":"before-first","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3, .markdown-section h4","showByDefault":true},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"panels":{},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"ALICE Analysis Tutorial","gitbook":"*","description":"Introduction to the common analysis techniques and tools of ALICE"},"file":{"path":"building/build.md","mtime":"2024-08-14T15:00:34.330Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-08-14T15:01:22.627Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-panels/panels.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

